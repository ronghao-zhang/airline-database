---
title: "CSDS341_Project_Final_Report"
author: "Jiamu_Zhang"
date: "`r Sys.Date()`"
output: html_document
---

## CSDS341_Project_Airline_Query_Database


### Background:



### ER-Diagram:
This is the **ER** diagram of our *Airline database system*





```{r ER-Diagram, echo=FALSE, fig.cap="CSDS341 Airline Database ER-Diagram", out.width = '90%',fig.align="center"}
knitr::include_graphics("CSDS341_Project_ER_Diagram.jpeg")
```
\
\

### Relational Schema (SQL Language):
**Table of Travelers:**
```
CREATE TABLE IF NOT EXISTS Travelers (
    user_id INT NOT NULL,
    first_name VARCHAR(50),
    middle_name VARCHAR(50),
    last_name VARCHAR(50),
    gender CHAR(1),
    dob DATE,
    credits INT DEFAULT 0,
    passport_no VARCHAR(20),
    citizenship VARCHAR(30),
    PRIMARY KEY (user_id),
    CHECK (gender IN ('M' , 'F', 'U'))
);
```
\
**Table of Crew:**
```
CREATE TABLE IF NOT EXISTS Crew (
    user_id INT NOT NULL,
    first_name VARCHAR(50),
    middle_name VARCHAR(50),
    last_name VARCHAR(50),
    gender CHAR(1),
    dob DATE,
    ssn INT NOT NULL,
    salary DOUBLE,
    total_distance INT,
    PRIMARY KEY (user_id),
    CHECK (gender IN ('M' , 'F', 'U'))
);
```
\
**Table of Airports:**
```
CREATE TABLE IF NOT EXISTS Airports (
    iata_code CHAR(3) NOT NULL,
    airport_name VARCHAR(100), 
    country CHAR(2),
    weather VARCHAR(30),
    airport_status VARCHAR(30),
    PRIMARY KEY (iata_code),
    CHECK (weather IN ('Sunny' , 'Mostly Sunny',
        'Partly Cloudy',
        'Cloudy',
        'Rainy',
        'Heavy Rainy',
        'Foggy',
        'Snowy',
        'Heavy Snowy',
        'Frost')),
    CHECK (airport_status IN ('Free', 'Normal',
        'Busy',
        'Small-Scale Delay',
        'Large-Scale Delay'))
);
```
\
**Table of Airlines:**
```
CREATE TABLE IF NOT EXISTS Airlines (
    company_id INT NOT NULL,
    company_name VARCHAR(50),
    PRIMARY KEY (company_id)
);
```
\
**Table of Schedules:**
```
CREATE TABLE IF NOT EXISTS Schedules (
    schedule_id INT NOT NULL,
    dept_date DATE,
    dept_time TIME,
    ariv_date DATE, 
    ariv_time TIME,
    PRIMARY KEY (schedule_id)
);
```
\
**Table of Aeroplanes_belong:**
```
CREATE TABLE IF NOT EXISTS Aeroplanes_belong (
    regis_no VARCHAR(10) NOT NULL,
    fir_capacity INT,
    bus_capacity INT,
    eco_capacity INT,
    aircraft_type VARCHAR(50),
    company_id INT NOT NULL,
    PRIMARY KEY (regis_no),
    FOREIGN KEY (company_id)
        REFERENCES Airlines(company_id)
);
```
\
**Table of Flights_ariv_dept:**
```
CREATE TABLE IF NOT EXISTS Flights_ariv_dept (
    regis_no VARCHAR(10) NOT NULL,
    flight_no VARCHAR(7) NOT NULL,
    flight_status VARCHAR(10),
    dept_iata_code CHAR(3) NOT NULL,
    ariv_iata_code CHAR(3) NOT NULL,
    PRIMARY KEY (regis_no, flight_no),
    FOREIGN KEY (regis_no)
        REFERENCES Aeroplanes_belong(regis_no),
    FOREIGN KEY (dept_iata_code)
        REFERENCES Airports(iata_code),
    FOREIGN KEY (dept_iata_code)
        REFERENCES Airports(iata_code),
    CHECK (flight_status IN ('On-Time' , 'Delay', 'Cancel'))
);
```
\
**Table of Tickets_book_for:**
```
CREATE TABLE IF NOT EXISTS Tickets_book_for (
    ticket_id INT NOT NULL,
    seat_location CHAR(4),
    seat_class CHAR(1),
    luggage_no INT,
    regis_no VARCHAR(10) NOT NULL,
    flight_no VARCHAR(7) NOT NULL,
    traveler_id INT NOT NULL,
    PRIMARY KEY (ticket_id),
    FOREIGN KEY (traveler_id)
        REFERENCES Travelers(user_id),
	FOREIGN KEY (regis_no, flight_no)
        REFERENCES Flights_ariv_dept(regis_no, flight_no),
    CHECK (seat_class IN ('F' , 'B', 'E'))
);
```
\
**Table of serve:**
```
CREATE TABLE IF NOT EXISTS serve (
    crew_id INT NOT NULL,
    regis_no VARCHAR(10) NOT NULL,
    flight_no VARCHAR(7) NOT NULL,
    PRIMARY KEY (crew_id , regis_no , flight_no),
    FOREIGN KEY (crew_id)
        REFERENCES Crew(user_id),
    FOREIGN KEY (regis_no, flight_no)
        REFERENCES Flights_ariv_dept(regis_no, flight_no)
);
```
\
**Table of assign:**
```
CREATE TABLE IF NOT EXISTS assign (
    regis_no VARCHAR(10) NOT NULL,
    flight_no VARCHAR(7) NOT NULL,
    schedule_id INT NOT NULL,
    PRIMARY KEY (regis_no , flight_no , schedule_id),
    FOREIGN KEY (regis_no, flight_no)
        REFERENCES Flights_ariv_dept(regis_no, flight_no),
    FOREIGN KEY (schedule_id)
        REFERENCES Schedules(schedule_id)
);
```
\
**Table of hub:**
```
CREATE TABLE IF NOT EXISTS hub (
    company_id INT NOT NULL,
    iata_code CHAR(3) NOT NULL,
    PRIMARY KEY (company_id , iata_code),
    FOREIGN KEY (company_id)
        REFERENCES Airlines(company_id),
    FOREIGN KEY (iata_code)
        REFERENCES Airports(iata_code)
);
```
\
**Note: In order to prevent redundancy, the relational schema for relation "book" and "for" are not necessary to create by included both inside the "Tickets_book_for" table.**
\
\

### Primary Key Constraints:

1. The primary key attribute of the entities **Travelers** and **Crew** are both **user_id** which is distinct for each one of the travelers.

2. The **Airport** has a primary key attribute **iata_code** which is unique for every single airport.

3. The primary key attribute of the **Airlines** is **company_id**.

4. The primary key attribute of the **Schedules** is **schedule_id**.

5. The primary key attribute of the **Aeroplanes_belong** is **regis_no**.

6. The primary key attribute of the **Flights_ariv_dept** is **regis_no** and **flight_no**.

7. The primary key attribute of the **Tickets_book_for** is **ticket_id**.

8. The primary key attribute of the **serve** is **crew_id**, **regin_no** and **flight_no**.

9. The primary key attribute of the **assign** is **regis_no**, **flight_no** and **schedule_id**.

10. The primary key attribute of the **hub** is **company_id** and **iata_code**.





